---
title: "Other_CCA"
output:
  html_document:
    df_print: paged
date: "2023-03-21"
always_allow_html: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(lava)
library(matlab)
library(plyr)
library(ggplot2)
library(plotly)
library(RGCCA)

```

```{r evaluation}

FS_MCC = function(U,V,W){
  library(caret)
  Label = c(rep(1,2),rep(0,18))
  tp = 0
  tn = 0
  fn = 0
  fp = 0
  
  pred = as.numeric(abs(U)>mean(abs(U)))
  C = confusionMatrix(as.factor(pred), reference = as.factor(Label))
  
  tp = tp + C$table[4]
  tn = tn + C$table[1]
  fn = fn + C$table[3]
  fp = fp + C$table[2]
  
  pred = as.numeric(abs(V)>mean(abs(V)))
  C = confusionMatrix(as.factor(pred), reference = as.factor(Label))
  
  tp = tp + C$table[4]
  tn = tn + C$table[1]
  fn = fn + C$table[3]
  fp = fp + C$table[2]
  
  pred = as.numeric(abs(W)>mean(abs(W)))
  C = confusionMatrix(as.factor(pred), reference = as.factor(Label))
  
  tp = tp + C$table[4]
  tn = tn + C$table[1]
  fn = fn + C$table[3]
  fp = fp + C$table[2]
  acc = (tp + tn) / (tp+tn+fp+fn)
  
  precision = tp/(tp+fp)
  recall = tp/(tp+fn)
  f1 = 2*precision*recall/(precision+recall)
  mcc = (tp*tn-fp*fn)/sqrt((tp+fp)*(tp+fn)*(tn+fp)*(tn+fn))
  
  return(list(Accruacy = acc,F1 = f1,MCC = mcc))
}

```

gendata3
```{r gendata3}
gendata3 <- function(n,p,q,r,type){
  

  #n=1000
  #p=20
  #q=20
  #r=20
  
  X = matrix(rnorm(n*p,mean=0,sd=1),nrow=n,ncol=p)
  Y = matrix(rnorm(n*q,mean=0,sd=1),nrow=n,ncol=q)
  Z = matrix(rnorm(n*q,mean=0,sd=1),nrow=n,ncol=r)
  
  if(type == 1){
    Y[,1] = X[,1] + X[,2] - Y[,2] + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
    Z[,1] = 2*(X[,1] + X[,2]) - Z[,2] + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
  }else if(type == 2 ){
    Y[,1] = 1 * sin(1 *matrix(X[,1] + X[,2],nrow=nrow(X),ncol=1)) - Y[,2] + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
    Z[,1] = 1 * cos(1 *matrix(Y[,1] + Y[,2],nrow=nrow(Y),ncol=1)) - Z[,2] + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
  } else if(type == 3){
    Y[,1] = (X[,1] + X[,2])^3 - Y[,2] + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
    Z[,1] = (Y[,1] + Y[,2])^2 - Z[,2] + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
  } else if(type == 4){
    Y[,1] = cos(X[,1]+X[,2]) -Y[,2]
    Z[,1] = sin(X[,1]+X[,2]) -Z[,2]
  }else if(type == 5){
    
    Z[,1] = sqrt(30-(X[,1]+X[,2])^2 - (Y[,1]+Y[,2])^2) -Z[,2]
  }
  
  return (list(X=X,Y=Y,Z=Z))
  
}

```

```{r gendata_loop}
gendatan = function(i,n,p,q,r,type){
  
  X = matrix(rnorm(n*p,mean=0,sd=1),nrow=n,ncol=p)
  Y = matrix(rnorm(n*q,mean=0,sd=1),nrow=n,ncol=q)
  Z = matrix(rnorm(n*q,mean=0,sd=1),nrow=n,ncol=r)
  
  if(i == 2){
    if(type ==1){
    Y[,1] = X[,1] + X[,2] - Y[,2] + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
    Z[,1] = 2*(X[,1] + X[,2]) - Z[,2] + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
  }else if(type ==2 ){
    Y[,1] = 1 * sin(1 *matrix(X[,1] + X[,2],nrow=nrow(X),ncol=1)) - Y[,2] + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
    Z[,1] = 1 * cos(1 *matrix(Y[,1] + Y[,2],nrow=nrow(Y),ncol=1)) - Z[,2] + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
  } else if(type ==3){
    Y[,1] = (X[,1] + X[,2])^3 - Y[,2] + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
    Z[,1] = (X[,1] + X[,2])^2 - Z[,2] + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
  } else if(type ==4){
    Y[,1] = cos(X[,1]+X[,2]) -Y[,2]
    Z[,1] = sin(X[,1]+X[,2]) -Z[,2]
  }else if(type ==5){
    
    Z[,1] = sqrt(4-(X[,1]+X[,2])^2 - (Y[,1]+Y[,2])^2) -Z[,2]
  }
  }else{
    if(type ==1){
    Y[,1] = rowSums(X[,1:i]) - rowSums(Y[,2:i]) + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
    Z[,1] = 2*rowSums(X[,1:i]) - rowSums(Z[,2:i]) + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
  }else if(type ==2 ){
    Y[,1] = 1 * sin(1 *matrix(rowSums(X[,1:i]),nrow=nrow(X),ncol=1)) - rowSums(Y[,2:i]) + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
    Z[,1] = 1 * sin(1 *matrix(rowSums(X[,1:i]),nrow=nrow(Y),ncol=1)) - rowSums(Z[,2:i]) + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
  } else if(type ==3){
    Y[,1] = 20 / (rowSums(X[,1:i])) - rowSums(Y[,2:i]) + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
    Z[,1] = 20 / (rowSums(X[,1:i])) - rowSums(Z[,2:i]) + matrix(rnorm(n,mean=0,sd=0.05),nrow=n,ncol=1)
  } else if(type ==4){
    Y[,1] = cos(rowSums(X[,1:i])) - rowSums(Y[,2:i])
    Z[,1] = sin(rowSums(X[,1:i])) - rowSums(Y[,2:i])
  }else if(type ==5){
    
    Z[,1] = sqrt(30-(X[,1]+X[,2])^2 - (Y[,1]+Y[,2])^2) -Z[,2]
  }
  }
  
  
  return(list(X=X,Y=Y,Z=Z)) 
}

Data1 = gendatan(2,300,20,20,20,1)



```

```{r}
#U_view1 = list()
#U_view2 = list()
#U_view3 = list()

#for(i in 2:10){
  #for(type in 1:4){
    #Data1 = gendatan(i,300,20,20,20,type)
      #result.rgcca = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,length(Data1)), 
                           #scheme = "centroid", init = "svd",bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
      #result.sgcca = sgcca(Data1, connection = 1 - diag(length(Data1)), sparsity = rep(1, length(Data1)), ncomp = rep(1,length(Data1)), scheme = "centroid", init = "svd",
                            #bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
      
  #}
  
#}

# F1 Score
# MCC
# 

```

### Linear GCCA
```{r}
## default N = 400 Scenario 1
Data1 = gendata3(400,20,20,20,1)

result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
length(Data1)), scheme = "centroid", init = "svd",
bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
trans=result$Y
u=result$a[[1]]
v=result$a[[2]]
w=result$a[[3]]

r.1 = FS_MCC(u,v,w)
print(r.1$F1)


x_new=array(trans[[1]])
y_new=array(trans[[2]])
z_new=array(trans[[3]])
x_ground = Data1$X[,1] + Data1$X[,2]
y_ground = Data1$Y[,1] + Data1$Y[,2]
z_ground = Data1$Z[,1] + Data1$Z[,2]


data <- data.frame(x_new=x_new,y_new=y_new,z_new=z_new,x_ground=x_ground,y_ground=y_ground,z_ground=z_ground)
px = ggplot(data) +
  geom_point(aes(x = x_new ,y =y_new),alpha = .5) +
  geom_smooth(aes(x = x_ground ,y =y_ground),alpha = .5) +
  scale_colour_brewer(palette = "Set1")
ggsave(px,filename = "r1_x.png")
px
py = ggplot(data) +
  geom_point(aes(x = x_new ,y =z_new),alpha = .5) +
  geom_smooth(aes(x = x_ground ,y =z_ground),alpha = .5) +
  scale_colour_brewer(palette = "Set1")
ggsave(py,filename = "r1_y.png")
py
pz = ggplot(data) +
  geom_point(aes(x = y_new ,y =z_new),alpha = .5) +
  geom_smooth(aes(x = y_ground ,y =z_ground),alpha = .5) +
  scale_colour_brewer(palette = "Set1")
ggsave(pz,filename = "r1_z.png")
pz

data.3d = data.frame(rbind(cbind(as.matrix(data[,1:3]),type = "new"),cbind(as.matrix(data[,4:6]),type = "ground")))

plot_ly(data.3d,x=~x_new, y=~y_new, z=~z_new, type="scatter3d", mode="markers",color=~data.3d$type)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  if(i %% 100 == 0){print(i)}
  Data1 = gendata3(400,20,20,20,1)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)

  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)
```


### Linear RGCCA
```{r}

Data1 = gendata3(400,20,20,20,1)

result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
length(Data1)), scheme = "centroid", init = "svd",
bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
trans=result$Y
u=result$a[[1]]
v=result$a[[2]]
w=result$a[[3]]

r.1 = FS_MCC(u,v,w)
print(r.1$F1)


x_new=array(trans[[1]])
y_new=array(trans[[2]])
z_new=array(trans[[3]])
x_ground = Data1$X[,1] + Data1$X[,2]
y_ground = Data1$Y[,1] + Data1$Y[,2]
z_ground = Data1$Z[,1] + Data1$Z[,2]


data <- data.frame(x_new=x_new,y_new=y_new,z_new=z_new,x_ground=x_ground,y_ground=y_ground,z_ground=z_ground)
px = ggplot(data) +
  geom_point(aes(x = x_new ,y =y_new),alpha = .5) +
  geom_smooth(aes(x = x_ground ,y =y_ground),alpha = .5) +
  scale_colour_brewer(palette = "Set1")
ggsave(px,filename = "r1_x.png")
px
py = ggplot(data) +
  geom_point(aes(x = x_new ,y =z_new),alpha = .5) +
  geom_smooth(aes(x = x_ground ,y =z_ground),alpha = .5) +
  scale_colour_brewer(palette = "Set1")
ggsave(py,filename = "r1_y.png")
py
pz = ggplot(data) +
  geom_point(aes(x = y_new ,y =z_new),alpha = .5) +
  geom_smooth(aes(x = y_ground ,y =z_ground),alpha = .5) +
  scale_colour_brewer(palette = "Set1")
ggsave(pz,filename = "r1_z.png")
pz

data.3d = data.frame(rbind(cbind(as.matrix(data[,1:3]),type = "new"),cbind(as.matrix(data[,4:6]),type = "ground")))

plot_ly(data.3d,x=~x_new, y=~y_new, z=~z_new, type="scatter3d", mode="markers",color=~data.3d$type)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  if(i %% 100 == 0){print(i)}
  Data1 = gendata3(400,20,20,20,1)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)

  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)

## N = 100
ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  if(i %% 100 == 0){print(i)}
  Data1 = gendata3(100,20,20,20,1)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)

  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)

# N = 800
ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  if(i %% 100 == 0){print(i)}
  Data1 = gendata3(800,20,20,20,1)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)

  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)
# N = 1200
ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  if(i %% 100 == 0){print(i)}
  Data1 = gendata3(1200,20,20,20,1)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)

  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)
# N = 1500
ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  if(i %% 100 == 0){print(i)}
  Data1 = gendata3(1500,20,20,20,1)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)

  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)
```

### Linear SGCCA
```{r}
result = rgcca(Data1, connection = 1 - diag(length(Data1)), sparsity = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)

trans=result$Y
u=result$a[[1]]
v=result$a[[2]]
w=result$a[[3]]

s.1 = FS_MCC(u,v,w)
print(FS_MCC(u,v,w))
x_new=array(trans[[1]])
y_new=array(trans[[2]])
z_new=array(trans[[3]])
x_ground = Data1$X[,1] + Data1$X[,2]
y_ground = Data1$Y[,1] + Data1$Y[,2]
z_ground = Data1$Z[,1] + Data1$Z[,2]


data <- data.frame(x_new=x_new,y_new=y_new,z_new=z_new,x_ground=x_ground,y_ground=y_ground,z_ground=z_ground)
px = ggplot(data) +
  geom_point(aes(x = x_new ,y =y_new),alpha = .5) +
  geom_smooth(aes(x = x_ground ,y =y_ground),alpha = .5) +
  scale_colour_brewer(palette = "Set1")
ggsave(px,filename = "s1_x.png")
px
py = ggplot(data) +
  geom_point(aes(x = x_new ,y =z_new),alpha = .5) +
  geom_smooth(aes(x = x_ground ,y =z_ground),alpha = .5) +
  scale_colour_brewer(palette = "Set1")
ggsave(py,filename = "s1_y.png")
py
pz = ggplot(data) +
  geom_point(aes(x = y_new ,y =z_new),alpha = .5) +
  geom_smooth(aes(x = y_ground ,y =z_ground),alpha = .5) +
  scale_colour_brewer(palette = "Set1")
ggsave(pz,filename = "s1_z.png")
pz

data.3d = data.frame(rbind(cbind(as.matrix(data[,1:3]),type = "new"),cbind(as.matrix(data[,4:6]),type = "ground")))

plot_ly(data.3d,x=~x_new, y=~y_new, z=~z_new, type="scatter3d", mode="markers",color=~data.3d$type)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(400,20,20,20,1)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), sparsity = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(400,20,20,20,1)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), sparsity = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(100,20,20,20,1)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), sparsity = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(800,20,20,20,1)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), sparsity = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(1200,20,20,20,1)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), sparsity = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(1500,20,20,20,1)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), sparsity = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}

mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)

```

### Sin RGCCA
```{r}
Data2 = gendata3(400,20,20,20,2)

result = rgcca(Data2, connection = 1 - diag(length(Data2)), tau = rep(1, length(Data2)), ncomp = rep(1,
length(Data2)), scheme = "centroid", init = "svd",
bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
trans=result$Y
u=result$a[[1]]
v=result$a[[2]]
w=result$a[[3]]

s.2 = FS_MCC(u,v,w)
print(FS_MCC(u,v,w))
x_new=array(trans[[1]])
y_new=array(trans[[2]])
z_new=array(trans[[3]])
x_ground = Data2$X[,1] + Data2$X[,2]
y_ground = Data2$Y[,1] + Data2$Y[,2]
z_ground = Data2$Z[,1] + Data2$Z[,2]


data <- data.frame(x_new=x_new,y_new=y_new,z_new=z_new,x_ground=x_ground,y_ground=y_ground,z_ground=z_ground)
px = ggplot(data) +
  geom_point(aes(x = x_new ,y =y_new),alpha = .5) +
  geom_point(aes(x = x_ground ,y =y_ground),color = "red") +

  scale_colour_brewer(palette = "Set1")
ggsave(px,filename = "s2_x.png")
px
py = ggplot(data) +
  geom_point(aes(x = x_new ,y =z_new),alpha = .5) +
  geom_point(aes(x = x_ground ,y =z_ground),color = "red") +

  scale_colour_brewer(palette = "Set1")
ggsave(py,filename = "s2_y.png")
py
pz = ggplot(data) +
  geom_point(aes(x = y_new ,y =z_new),alpha = .5) +
  geom_point(aes(x = y_ground ,y =z_ground),color = "red") +

  scale_colour_brewer(palette = "Set1")
ggsave(pz,filename = "s2_z.png")
pz

data.3d = data.frame(rbind(cbind(as.matrix(data[,1:3]),type = "new"),cbind(as.matrix(data[,4:6]),type = "ground")))

plot_ly(data.3d,x=~x_new, y=~y_new, z=~z_new, type="scatter3d", mode="markers",color=~data.3d$type)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(400,20,20,20,2)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(100,20,20,20,2)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = T)

mean(f1_score)
sd(f1_score, na.rm = T)

mean(MCC)
sd(MCC, na.rm = T)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(800,20,20,20,2)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = T)

mean(f1_score)
sd(f1_score, na.rm = T)

mean(MCC)
sd(MCC, na.rm = T)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(1200,20,20,20,2)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = T)

mean(f1_score)
sd(f1_score, na.rm = T)

mean(MCC)
sd(MCC, na.rm = T)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(1500,20,20,20,2)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = T)

mean(f1_score)
sd(f1_score, na.rm = T)

mean(MCC)
sd(MCC, na.rm = T)

```

### Sin SGCCA
```{r}
result = sgcca(Data2, connection = 1 - diag(length(Data2)), sparsity = rep(1, length(Data2)), ncomp = rep(1,
  length(Data2)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
trans=result$Y
u=result$a[[1]]
v=result$a[[2]]
w=result$a[[3]]

s.2 = FS_MCC(u,v,w)
print(FS_MCC(u,v,w))
x_new=array(trans[[1]])
y_new=array(trans[[2]])
z_new=array(trans[[3]])
x_ground = Data2$X[,1] + Data2$X[,2]
y_ground = Data2$Y[,1] + Data2$Y[,2]
z_ground = Data2$Z[,1] + Data2$Z[,2]


data <- data.frame(x_new=x_new,y_new=y_new,z_new=z_new,x_ground=x_ground,y_ground=y_ground,z_ground=z_ground)
px = ggplot(data) +
  geom_point(aes(x = x_new ,y =y_new),alpha = .5) +
  geom_point(aes(x = x_ground ,y =y_ground),color = "red") +

  scale_colour_brewer(palette = "Set1")
ggsave(px,filename = "s2_x.png")
px
py = ggplot(data) +
  geom_point(aes(x = x_new ,y =z_new),alpha = .5) +
  geom_point(aes(x = x_ground ,y =z_ground),color = "red") +

  scale_colour_brewer(palette = "Set1")
ggsave(py,filename = "s2_y.png")
py
pz = ggplot(data) +
  geom_point(aes(x = y_new ,y =z_new),alpha = .5) +
  geom_point(aes(x = y_ground ,y =z_ground),color = "red") +

  scale_colour_brewer(palette = "Set1")
ggsave(pz,filename = "s2_z.png")
pz

data.3d = data.frame(rbind(cbind(as.matrix(data[,1:3]),type = "new"),cbind(as.matrix(data[,4:6]),type = "ground")))

plot_ly(data.3d,x=~x_new, y=~y_new, z=~z_new, type="scatter3d", mode="markers",color=~data.3d$type)

ACC = rep(0,500)
f1_score = rep(0,100)
MCC = rep(0,100)
for( i in 1:100){
  Data1 = gendata3(400,20,20,20,2)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = T)

mean(f1_score)
sd(f1_score, na.rm = T)

mean(MCC)
sd(MCC, na.rm = T)

ACC = rep(0,500)
f1_score = rep(0,100)
MCC = rep(0,100)
for( i in 1:100){
  Data1 = gendata3(100,20,20,20,2)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), sparsity = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = T)

mean(f1_score,na.rm = T)
sd(f1_score, na.rm = T)

mean(MCC)
sd(MCC, na.rm = T)

ACC = rep(0,500)
f1_score = rep(0,100)
MCC = rep(0,100)
for( i in 1:100){
  Data1 = gendata3(800,20,20,20,2)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), sparsity = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = T)

mean(f1_score)
sd(f1_score, na.rm = T)

mean(MCC)
sd(MCC, na.rm = T)

ACC = rep(0,500)
f1_score = rep(0,100)
MCC = rep(0,100)
for( i in 1:100){
  Data1 = gendata3(1200,20,20,20,2)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), sparsity = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = T)

mean(f1_score)
sd(f1_score, na.rm = T)

mean(MCC)
sd(MCC, na.rm = T)

ACC = rep(0,500)
f1_score = rep(0,100)
MCC = rep(0,100)
for( i in 1:100){
  Data1 = gendata3(1500,20,20,20,2)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), sparsity = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = T)

mean(f1_score)
sd(f1_score, na.rm = T)

mean(MCC)
sd(MCC, na.rm = T)
```

### Method3 RGCCA
```{r}
Data3 = gendata3(400,20,20,20,3)

result = rgcca(Data3, connection = 1 - diag(length(Data3)), tau = rep(1, length(Data3)), ncomp = rep(1,
length(Data3)), scheme = "centroid", init = "svd",
bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
trans=result$Y
u=result$a[[1]]
v=result$a[[2]]
w=result$a[[3]]

s.2 = FS_MCC(u,v,w)
print(FS_MCC(u,v,w))
x_new=array(trans[[1]])
y_new=array(trans[[2]])
z_new=array(trans[[3]])
x_ground = Data3$X[,1] + Data3$X[,2]
y_ground = Data3$Y[,1] + Data3$Y[,2]
z_ground = Data3$Z[,1] + Data3$Z[,2]


data <- data.frame(x_new=x_new,y_new=y_new,z_new=z_new,x_ground=x_ground,y_ground=y_ground,z_ground=z_ground)
px = ggplot(data) +
  geom_point(aes(x = x_new ,y =y_new),alpha = .5) +
  geom_point(aes(x = x_ground ,y =y_ground),color = "red") +

  scale_colour_brewer(palette = "Set1")
ggsave(px,filename = "s2_x.png")
px
py = ggplot(data) +
  geom_point(aes(x = x_new ,y =z_new),alpha = .5) +
  geom_point(aes(x = x_ground ,y =z_ground),color = "red") +

  scale_colour_brewer(palette = "Set1")
ggsave(py,filename = "s2_y.png")
py
pz = ggplot(data) +
  geom_point(aes(x = y_new ,y =z_new),alpha = .5) +
  geom_point(aes(x = y_ground ,y =z_ground),color = "red") +

  scale_colour_brewer(palette = "Set1")
ggsave(pz,filename = "s2_z.png")
pz

data.3d = data.frame(rbind(cbind(as.matrix(data[,1:3]),type = "new"),cbind(as.matrix(data[,4:6]),type = "ground")))

plot_ly(data.3d,x=~x_new, y=~y_new, z=~z_new, type="scatter3d", mode="markers",color=~data.3d$type)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(400,20,20,20,3)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(100,20,20,20,3)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = T)

mean(f1_score)
sd(f1_score, na.rm = T)

mean(MCC)
sd(MCC, na.rm = T)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(800,20,20,20,3)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = T)

mean(f1_score)
sd(f1_score, na.rm = T)

mean(MCC)
sd(MCC, na.rm = T)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(1200,20,20,20,3)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = T)

mean(f1_score)
sd(f1_score, na.rm = T)

mean(MCC)
sd(MCC, na.rm = T)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(1500,20,20,20,3)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = T)

mean(f1_score)
sd(f1_score, na.rm = T)

mean(MCC)
sd(MCC, na.rm = T)

```

### Method3 SGCCA
```{r}
result = sgcca(Data3, connection = 1 - diag(length(Data3)), sparsity = rep(1, length(Data3)), ncomp = rep(1,
  length(Data3)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
trans=result$Y
u=result$a[[1]]
v=result$a[[2]]
w=result$a[[3]]

print(FS_MCC(u,v,w))
x_new=array(trans[[1]])
y_new=array(trans[[2]])
z_new=array(trans[[3]])
x_ground = Data3$X[,1] + Data3$X[,2]
y_ground = Data3$Y[,1] + Data3$Y[,2]
z_ground = Data3$Z[,1] + Data3$Z[,2]

data <- data.frame(x_new=x_new,y_new=y_new,z_new=z_new,x_ground=x_ground,y_ground=y_ground,z_ground=z_ground)
px = ggplot(data) +
  geom_point(aes(x = x_new ,y =y_new),alpha = .5) +
  geom_point(aes(x = x_ground ,y =y_ground),color = "red") +

  scale_colour_brewer(palette = "Set1")
ggsave(px,filename = "s2_x.png")
px
py = ggplot(data) +
  geom_point(aes(x = x_new ,y =z_new),alpha = .5) +
  geom_point(aes(x = x_ground ,y =z_ground),color = "red") +

  scale_colour_brewer(palette = "Set1")
ggsave(py,filename = "s2_y.png")
py
pz = ggplot(data) +
  geom_point(aes(x = y_new ,y =z_new),alpha = .5) +
  geom_point(aes(x = y_ground ,y =z_ground),color = "red") +

  scale_colour_brewer(palette = "Set1")
ggsave(pz,filename = "s2_z.png")
pz

data.3d = data.frame(rbind(cbind(as.matrix(data[,1:3]),type = "new"),cbind(as.matrix(data[,4:6]),type = "ground")))

plot_ly(data.3d,x=~x_new, y=~y_new, z=~z_new, type="scatter3d", mode="markers",color=~data.3d$type)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(400,20,20,20,3)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(400,20,20,20,3)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(100,20,20,20,3)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(800,20,20,20,3)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(1200,20,20,20,3)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)

ACC = rep(0,500)
f1_score = rep(0,500)
MCC = rep(0,500)
for( i in 1:500){
  Data1 = gendata3(1500,20,20,20,3)
  result = rgcca(Data1, connection = 1 - diag(length(Data1)), tau = rep(1, length(Data1)), ncomp = rep(1,
  length(Data1)), scheme = "centroid", init = "svd",
  bias = TRUE, tol = .Machine$double.eps, verbose = FALSE)
  trans=result$Y
  u=result$a[[1]]
  v=result$a[[2]]
  w=result$a[[3]]
  
  r.1 = FS_MCC(u,v,w)
  ACC[i] = r.1$Accruacy
  f1_score[i] = r.1$F1
  MCC[i] = r.1$MCC
}
mean(ACC)
sd(ACC, na.rm = FALSE)

mean(f1_score)
sd(f1_score, na.rm = FALSE)

mean(MCC)
sd(MCC, na.rm = FALSE)
```
