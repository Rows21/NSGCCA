---
title: "Plot"
author: "RongWu"
date: "2023-07-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(openxlsx)
library(gridExtra)

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
data = read.csv('simulation1_p.csv')


ggplot(data = data, aes(x=Kernel.Size,y=Values,group=Case,color=Case,shape=Case)) +
  facet_wrap("Methods ~ ") +
  geom_point(size=2)
  

count = 0
for(i in 1:3){
  Sample_C = subset(Simulation2_Sample, Case == i)

    p_Accuracy = ggplot(Sample_C,aes(x=Sample_Size,y=Accuracy,group=Method,color=Method,shape=Method)) + 
      geom_point(size=2) + 
      geom_line(linewidth=.5) + 
      geom_errorbar(aes(ymin=Accuracy-A_sd, ymax=Accuracy+A_sd), width=.02)

    plots[[3*i-2]] = p_Accuracy
    
    p_F_Score = ggplot(Sample_C,aes(x=Sample_Size,y=F_Score,group=Method,color=Method,shape=Method)) + 
      geom_point(size=2) + 
      geom_line(linewidth=.5) + 
      geom_errorbar(aes(ymin=F_Score-F_sd, ymax=F_Score+F_sd), width=.02)

    plots[[3*i-1]] = p_F_Score
    
    p_MCC = ggplot(Sample_C,aes(x=Sample_Size,y=MCC,group=Method,color=Method,shape=Method)) + 
      geom_point(size=2) + 
      geom_line(linewidth=.5) + 
      geom_errorbar(aes(ymin=MCC-M_sd, ymax=MCC+M_sd), width=.02)

    plots[[3*i]] = p_MCC
}

Res1 = grid.arrange(
  plots[[1]], plots[[2]], plots[[3]],
  plots[[4]], plots[[5]], plots[[6]],
  plots[[7]], plots[[8]], plots[[9]],
  ncol = 3
)

postscript("Figure_2a.eps", onefile = FALSE, horizontal = FALSE, paper = "special")
dev.off()
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
